# Предсказание ухода клиента для банка "Бета-Банк"
## Постановка задачи
"Бета-Банк" решает проблему оттока клиентов. Согласно расчетов маркетологов банка, сохранять текущих клиентов дешевле, чем привлекать новых.

Нужно научиться прогнозировать, уйдёт клиент из банка в ближайшее время или нет. Исходные данные для анализа - исторические данные о поведении клиентов и расторжении договоров с банком.

Нужно построить прогнозирующую модель с предельно большим значением F1-меры (не менее 0.59), затем проверить F1-меру на тестовой выборке. Дополнительно нужно измерять метрику AUC-ROC и сравнить её значения с F1-мерой.

## Решение задачи
Для решения задачи предсказания ухода клиента банка были построены и обучены модели трех типов: решающее дерево, случайный лес и логистическая регрессия. Был произведен подбор гиперпараметров моделей и выбрана лучшая модель для каждого типа.

Модели были обучены сначала без учета дисбаланса классов в датасете, а после с учетом этого дисбаланса. Для того, чтоб исправить дисбаланс, были испробованы два метода:

* обучающая выборка была увеличена методом upsampling, доля положительного (редкого) класса до ведена до 50%;
* модели были обучены с весовой балансировкой (при инициализации модели указан гиперпараметр class_weight='balanced').

Модели, обученные с учетом дисбаланса, показали лучшие результаты в сравнении с моделями, обученными без учета дисбаланса классов, хотя апсамплинг улучшил целевой показатель только для логистической регрессии.

Лучше всего себя показала модель решающего леса с гиперпараметрами: max_depth=8, n_estimators=80, class_weight='balanced', обученная на валидационной выборке, не измененной методом upsampling.

Модель рекомендуется дообучить и начать использовать в бизнесе.